<html><head>
<meta charset='UTF-8'>
<link href='resource/bootstrap.min.css' rel='Stylesheet' type='text/css' />
<link href='resource/style.css' rel='Stylesheet' type='text/css' />
</head>
<body>
<div id='page'>
<h1 class='entry-title'>Launching a website from a button in Office</h1>
 <a class='url fn n profile-usercard-hover' href='https://social.msdn.microsoft.com/profile/Andrew Coates [MSFT]' target='_blank'>Andrew Coates [MSFT]</a>
<time>    4/19/2009 12:36:40 AM</time>
<hr>
<div id='content'><p>There was a question on one of the internal lists today: &quot;Looking for a no-brainer way to demo just adding a simple button to Office that goes to a URL.&quot;</p>  <p>It’s going to work a little differently in Word &amp; Excel than it does in Outlook.</p>  <h2>Word/Excel/Etc (apps with Ribbon)</h2>  <p>For a Word/Excel addin, add a ribbon control and then add a button to that control.</p>  <p>For example, create a new Word 2007 Addin</p>  <p><img style="border-right-width: 0px; display: inline; border-top-width: 0px; border-bottom-width: 0px; border-left-width: 0px" title="New Project Dialog" border="0" alt="New Project Dialog" src="media/TNBlogsFS/BlogFileStorage/blogs_msdn/acoat/WindowsLiveWriter/LaunchingawebsitefromabuttoninOffice_CD76/image_3.png" original-url="http://blogs.msdn.com/blogfiles/acoat/WindowsLiveWriter/LaunchingawebsitefromabuttoninOffice_CD76/image_3.png" width="804" height="572" /> </p>  <p>Add a ribbon control</p>  <p><img style="border-right-width: 0px; display: inline; border-top-width: 0px; border-bottom-width: 0px; border-left-width: 0px" title="Add New Item Dialog" border="0" alt="Add New Item Dialog" src="media/TNBlogsFS/BlogFileStorage/blogs_msdn/acoat/WindowsLiveWriter/LaunchingawebsitefromabuttoninOffice_CD76/image_6.png" original-url="http://blogs.msdn.com/blogfiles/acoat/WindowsLiveWriter/LaunchingawebsitefromabuttoninOffice_CD76/image_6.png" width="804" height="484" /> 3</p>  <p>Change the caption of the Ribbon Group, drag a Button onto the group, change it’s image and caption etc</p>  <p><img style="border-right-width: 0px; display: inline; border-top-width: 0px; border-bottom-width: 0px; border-left-width: 0px" title="Ribbon button at design time" border="0" alt="Ribbon button at design time" src="media/TNBlogsFS/BlogFileStorage/blogs_msdn/acoat/WindowsLiveWriter/LaunchingawebsitefromabuttoninOffice_CD76/image_11.png" original-url="http://blogs.msdn.com/blogfiles/acoat/WindowsLiveWriter/LaunchingawebsitefromabuttoninOffice_CD76/image_11.png" width="531" height="289" /> </p>  <p>In the button click event use</p>  <div class="csharpcode">   <div id="codeSnippetWrapper">     <pre style="border-bottom-style: none; text-align: left; padding-bottom: 0px; line-height: 12pt; border-right-style: none; background-color: #f4f4f4; margin: 0em; padding-left: 0px; width: 100%; padding-right: 0px; font-family: &#39;Courier New&#39;, courier, monospace; direction: ltr; border-top-style: none; color: black; font-size: 8pt; border-left-style: none; overflow: visible; padding-top: 0px" id="codeSnippet">System.Diagnostics.Process.Start(<span style="color: #006080"><a href="http://blogs.msdn.com/acoat">http://blogs.msdn.com/acoat</a></span>);</pre>
  </div>

  <p>Press F5 and look in the Addins tab in Word when it launches.</p>

  <div><img style="border-right-width: 0px; display: inline; border-top-width: 0px; border-bottom-width: 0px; border-left-width: 0px" title="Addin in action" border="0" alt="Addin in action" src="media/TNBlogsFS/BlogFileStorage/blogs_msdn/acoat/WindowsLiveWriter/LaunchingawebsitefromabuttoninOffice_CD76/image_14.png" original-url="http://blogs.msdn.com/blogfiles/acoat/WindowsLiveWriter/LaunchingawebsitefromabuttoninOffice_CD76/image_14.png" width="634" height="239" /> </div>
</div>

<p>Click the button and the site launches in the system default browser.</p>

<h2>Outlook</h2>

<p>For Outlook of course, there’s no ribbon in the main app, so you need to add this code to the ThisAddIn_Startup event like Kirk Evans does it <a href="http://blogs.msdn.com/kaevans/archive/2009/03/18/export-your-opml-from-outlook.aspx">here</a> to add the button:</p>

<div id="codeSnippetWrapper">
  <pre style="border-bottom-style: none; text-align: left; padding-bottom: 0px; line-height: 12pt; border-right-style: none; background-color: #f4f4f4; margin: 0em; padding-left: 0px; width: 100%; padding-right: 0px; font-family: &#39;Courier New&#39;, courier, monospace; direction: ltr; border-top-style: none; color: black; font-size: 8pt; border-left-style: none; overflow: visible; padding-top: 0px" id="codeSnippet"><br /><span style="color: #0000ff">public</span> <span style="color: #0000ff">partial</span> <span style="color: #0000ff">class</span> ThisAddIn<br />{<br />    <br />    Microsoft.Office.Core.CommandBar bar;<br /><br />    Microsoft.Office.Core.CommandBarButton button;<br /><br /><br />    <span style="color: #0000ff">private</span> <span style="color: #0000ff">void</span> ThisAddIn_Startup(<span style="color: #0000ff">object</span> sender, System.EventArgs e)<br />    {<br />        AddCommandBar();<br />        AddCommandButton();<br />    }<br /><br />    <span style="color: #0000ff">private</span> <span style="color: #0000ff">void</span> ThisAddIn_Shutdown(<span style="color: #0000ff">object</span> sender, System.EventArgs e)<br />    {<br />    }<br /><br />    <span style="color: #cc6633">#region</span> VSTO generated code<br /><br />    <span style="color: #008000">/// &lt;summary&gt;</span><br />    <span style="color: #008000">/// Required method for Designer support - do not modify</span><br />    <span style="color: #008000">/// the contents of this method with the code editor.</span><br />    <span style="color: #008000">/// &lt;/summary&gt;</span><br />    <span style="color: #0000ff">private</span> <span style="color: #0000ff">void</span> InternalStartup()<br />    {<br />        <span style="color: #0000ff">this</span>.Startup += <span style="color: #0000ff">new</span> System.EventHandler(ThisAddIn_Startup);<br />        <span style="color: #0000ff">this</span>.Shutdown += <span style="color: #0000ff">new</span> System.EventHandler(ThisAddIn_Shutdown);<br />    }<br />    <br />    <span style="color: #cc6633">#endregion</span><br /><br />    <span style="color: #0000ff">private</span> <span style="color: #0000ff">void</span> AddCommandBar()<br />    {<br />        <span style="color: #008000">//Add the command bar</span><br />        bar = Globals.ThisAddIn.Application.ActiveExplorer().CommandBars.Add(<br />            <span style="color: #006080">&quot;Launch Site&quot;</span>,<br />            Office.MsoBarPosition.msoBarTop,<br />            <span style="color: #0000ff">false</span>,<br />            <span style="color: #0000ff">true</span>);<br />        bar.Protection = Office.MsoBarProtection.msoBarNoCustomize;<br />        bar.Visible = <span style="color: #0000ff">true</span>;<br />    }<br /><br />    <span style="color: #0000ff">private</span> <span style="color: #0000ff">void</span> AddCommandButton()<br />    {<br />        <span style="color: #008000">//Add a command button to the bar</span><br />        button = bar.Controls.Add(<br />            Office.MsoControlType.msoControlButton,<br />            Type.Missing,<br />            Type.Missing,<br />            Type.Missing,<br />            <span style="color: #0000ff">true</span>) <span style="color: #0000ff">as</span> Office.CommandBarButton;<br /><br />        button.Caption = <span style="color: #006080">&quot;Launch the Site&quot;</span>;<br />        button.Click += <span style="color: #0000ff">new</span> Office._CommandBarButtonEvents_ClickEventHandler(button_Click);<br />    }<br /><br />    <span style="color: #0000ff">void</span> button_Click(Office.CommandBarButton Ctrl, <span style="color: #0000ff">ref</span> <span style="color: #0000ff">bool</span> CancelDefault)<br />    {<br />        System.Diagnostics.Process.Start(<span style="color: #006080">&quot;http://blogs.msdn.com/acoat&quot;</span>);<br />    }<br />}<br /><br /></pre>
</div>

<p>Pressing F5 here will launch Outlook and add a new CommandBar and a new button to that CommandBar. </p>

<p><a href="media/TNBlogsFS/BlogFileStorage/blogs_msdn/acoat/WindowsLiveWriter/LaunchingawebsitefromabuttoninOffice_CD76/image_16.png" original-url="http://blogs.msdn.com/blogfiles/acoat/WindowsLiveWriter/LaunchingawebsitefromabuttoninOffice_CD76/image_16.png"><img style="border-bottom: 0px; border-left: 0px; display: inline; border-top: 0px; border-right: 0px" title="image" border="0" alt="image" src="media/TNBlogsFS/BlogFileStorage/blogs_msdn/acoat/WindowsLiveWriter/LaunchingawebsitefromabuttoninOffice_CD76/image_thumb_5.png" original-url="http://blogs.msdn.com/blogfiles/acoat/WindowsLiveWriter/LaunchingawebsitefromabuttoninOffice_CD76/image_thumb_5.png" width="145" height="137" /></a> </p>

<p>Clicking the button will launch the web site in the system default browser.</p><div class="wlWriterHeaderFooter" style="text-align:right; margin:0px; padding:4px 0px 4px 0px;"><script type="text/javascript">digg_url = "http://blogs.msdn.com/acoat/archive/2009/04/19/launching-a-website-from-a-button-in-office.aspx";digg_title = "Launching a website from a button in Office";digg_bgcolor = "#FFFFFF";digg_skin = "compact";</script><script src="http://digg.com/tools/diggthis.js" type="text/javascript"></script><script type="text/javascript">digg_url = undefined;digg_title = undefined;digg_bgcolor = undefined;digg_skin = undefined;</script></div></div>
</div></body>
<script type='text/javascript' src='resource/jquery-1.12.1.min.js'></script>
<script type='text/javascript' src='resource/replace.js'></script>
</html>
